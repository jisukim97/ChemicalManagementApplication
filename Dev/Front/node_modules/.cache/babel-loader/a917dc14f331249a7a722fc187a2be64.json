{"ast":null,"code":"var _jsxFileName = \"/Users/yeongmo/Documents/Programming/timeline/timeline/src/components/ArticleForm.js\";\nimport React, { Component } from 'react';\nimport { Form, Icon, Input, Button, Upload, Modal } from 'antd';\n\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onload = () => resolve(reader.result);\n\n    reader.onerror = error => reject(error);\n  });\n}\n\nconst TextArea = Input.TextArea;\n\nclass ArticleForm extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      previewVisible: false,\n      previewImage: '',\n      fileList: []\n    };\n\n    this.handleCancel = () => this.setState({\n      previewVisible: false\n    });\n\n    this.handlePreview = async file => {\n      if (!file.url && !file.preview) {\n        file.preview = await getBase64(file.originFileObj);\n      }\n\n      this.setState({\n        previewImage: file.url || file.preview,\n        previewVisible: true\n      });\n    };\n\n    this.handleChange = ({\n      fileList\n    }) => this.setState({\n      fileList\n    });\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      this.props.form.validateFields((err, values) => {\n        if (!err) {\n          //userID 임시 설정\n          let article = {\n            'userID': 1,\n            'content': values.content\n          };\n          console.log('Received values of form: ', values);\n          console.log(this.state.fileList); //여기서 각 원소의 originFileObj를 보내주면 됩니다\n\n          fetch('http://localhost:8080/article/insert', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(article)\n          }).then(response => response.json()).then(rsp => {\n            console.log(rsp);\n            const userID = 1; //임시로 넣어준 유저아이디\n\n            const articleID = rsp.data.articleID;\n            const files = [];\n            this.state.fileList.map(file => {\n              const data = new FormData();\n              data.append('file', file.originFileObj);\n              console.log(file.originFileObj);\n              files.push(data);\n            });\n            console.log(JSON.stringify(files));\n            fetch('http://localhost:8080/article/insertphoto/' + userID + '/' + articleID, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: {\n                files: JSON.stringify(files)\n              }\n            });\n          });\n        }\n      });\n    };\n  }\n\n  render() {\n    //여기부터 사진폼\n    const _this$state = this.state,\n          previewVisible = _this$state.previewVisible,\n          previewImage = _this$state.previewImage,\n          fileList = _this$state.fileList;\n    const uploadButton = React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"ant-upload-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, \"Upload\")); //여기까지가 사진 폼 \n\n    const getFieldDecorator = this.props.form.getFieldDecorator;\n    return React.createElement(Form, {\n      onSubmit: this.handleSubmit,\n      className: \"article-form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(Form.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, getFieldDecorator('content', {\n      rules: [{\n        required: true,\n        message: 'Please input your story!'\n      }]\n    })(React.createElement(TextArea, {\n      placeholder: \"\\uC624\\uB298 \\uBB34\\uC2A8 \\uC77C\\uC774 \\uC77C\\uC5B4\\uB0AC\\uB098\\uC694?\",\n      autosize: {\n        minRows: 5,\n        maxRows: 6\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }))), React.createElement(Form.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, getFieldDecorator('photo', {\n      rules: [{\n        required: false\n      }]\n    })(React.createElement(\"div\", {\n      className: \"clearfix\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(Upload, {\n      name: \"file\",\n      action: \"https://www.mocky.io/v2/5cc8019d300000980a055e76\",\n      listType: \"picture-card\",\n      fileList: fileList,\n      onPreview: this.handlePreview,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, fileList.length >= 5 ? null : uploadButton), React.createElement(Modal, {\n      visible: previewVisible,\n      footer: null,\n      onCancel: this.handleCancel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      alt: \"example\",\n      style: {\n        width: '100%'\n      },\n      src: previewImage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }))))), React.createElement(Form.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(Button, {\n      type: \"primary\",\n      htmlType: \"submit\",\n      className: \"article-form-button\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, \"Upload\")));\n  }\n\n}\n\nexport default Form.create()(ArticleForm);","map":{"version":3,"sources":["/Users/yeongmo/Documents/Programming/timeline/timeline/src/components/ArticleForm.js"],"names":["React","Component","Form","Icon","Input","Button","Upload","Modal","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","TextArea","ArticleForm","state","previewVisible","previewImage","fileList","handleCancel","setState","handlePreview","url","preview","originFileObj","handleChange","handleSubmit","e","preventDefault","props","form","validateFields","err","values","article","content","console","log","fetch","method","headers","body","JSON","stringify","then","response","json","rsp","userID","articleID","data","files","map","FormData","append","push","render","uploadButton","getFieldDecorator","rules","required","message","minRows","maxRows","length","width","create"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Form, Icon, Input, Button, Upload, Modal } from 'antd';\n\nfunction getBase64(file) {\n    return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = () => resolve(reader.result);\n        reader.onerror = error => reject(error);\n    });\n}  \n\nconst { TextArea } = Input;\n\nclass ArticleForm extends Component {\n\n    state = {\n        previewVisible: false,\n        previewImage: '',\n        fileList: [\n\n        ],\n    };\n\n    handleCancel = () => this.setState({ previewVisible: false });\n\n    handlePreview = async file => {\n        if (!file.url && !file.preview) {\n            file.preview = await getBase64(file.originFileObj);\n        }\n\n        this.setState({\n            previewImage: file.url || file.preview,\n            previewVisible: true,\n        });\n    };\n\n    handleChange = ({ fileList }) => this.setState({ fileList });\n\n    //여기위까지가 사진 폼 \n\n    handleSubmit = e => {\n        e.preventDefault();\n        this.props.form.validateFields((err, values) => {\n            if (!err) {\n                //userID 임시 설정\n                let article = {\n                    'userID' : 1,\n                    'content' : values.content\n                }\n                console.log('Received values of form: ', values);\n                console.log(this.state.fileList) //여기서 각 원소의 originFileObj를 보내주면 됩니다\n                fetch('http://localhost:8080/article/insert', {\n                    method:'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body : JSON.stringify(article)\n                }).then(response => response.json())\n                .then(rsp => {\n                    console.log(rsp)\n                    const userID = 1 //임시로 넣어준 유저아이디\n                    const articleID = rsp.data.articleID\n                    const files = []\n                    this.state.fileList.map(file => {\n                        const data = new FormData();\n                        data.append('file', file.originFileObj)\n                        console.log(file.originFileObj)\n                        files.push(data)\n                    })\n                    console.log(JSON.stringify(files))\n                    fetch('http://localhost:8080/article/insertphoto/'+userID+'/'+articleID, {\n                        method: 'POST',\n                        headers: { 'Content-Type': 'application/json' },\n                        body : {files :JSON.stringify(files)}\n                    })\n                })\n\n            }\n        });\n    };\n\n    render() {\n\n        //여기부터 사진폼\n\n        const { previewVisible, previewImage, fileList } = this.state;\n        const uploadButton = (\n          <div>\n            <Icon type=\"plus\" />\n            <div className=\"ant-upload-text\">Upload</div>\n          </div>\n        );\n        \n        //여기까지가 사진 폼 \n\n        const { getFieldDecorator } = this.props.form;\n\n        return (\n            <Form onSubmit={this.handleSubmit} className=\"article-form\">\n                <Form.Item>\n                    {getFieldDecorator('content', {\n                        rules: [{ required: true, message: 'Please input your story!' }],\n                    })(\n                        <TextArea\n                            placeholder=\"오늘 무슨 일이 일어났나요?\"\n                            autosize={{ minRows: 5, maxRows: 6 }}\n                        />,\n                    )}\n                </Form.Item>\n                <Form.Item>\n                    {getFieldDecorator('photo', {\n                        rules: [{ required: false }],\n                    })(\n                        <div className=\"clearfix\">\n                            <Upload\n                                name=\"file\"\n                                action=\"https://www.mocky.io/v2/5cc8019d300000980a055e76\"\n                                listType=\"picture-card\"\n                                fileList={fileList}\n                                onPreview={this.handlePreview}\n                                onChange={this.handleChange}\n                            >\n                                {fileList.length >= 5 ? null : uploadButton}\n                            </Upload>\n                            <Modal visible={previewVisible} footer={null} onCancel={this.handleCancel}>\n                                <img alt=\"example\" style={{ width: '100%' }} src={previewImage} />\n                            </Modal>\n                        </div>\n                    )}\n                </Form.Item>\n                <Form.Item>\n                    <Button type=\"primary\" htmlType=\"submit\" className=\"article-form-button\">\n                        Upload\n                    </Button>\n                </Form.Item>\n            </Form>\n        );\n    }\n}\n\nexport default Form.create()(ArticleForm);\n"]},"metadata":{},"sourceType":"module"}